@echo off
if "%1" == "clean" goto clean
@echo on

unpack000 -bm2
del *T.BM2 F*.BM2 THUM*.BM2 THLF*.BM2 BAR*.BM2 BUTTON*.BM2 NE*.BM2 OPTION*.BM2
del ALBUM.BM2 BG.BM2 DATE.BM2 FRAME.BM2 GENERAL.BM2 MAPSELECT.BM2 MEMOCA.BM2 SAKURA.BM2 SAVELOAD.BM2 TITLE.BM2 YESNO.BM2
th2bm2cmv *.BM2
pceth2bmp *.bmp
pgd16cnv -b *.bmp

copy /Y CAL\* .\

th2wav_mkbat > th2wav_setpath.bat
call th2wav_setpath
del *L.WAV SE_NONAME*.WAV NAME*.WAV
del SE_0206.WAV SE_2009.WAV SE_2010.WAV SE_2019.WAV SE_2021.WAV SE_2030.WAV SE_2103.WAV SE_2104.WAV SE_2105.WAV SE_2208.WAV SE_2211.WAV SE_2302.WAV SE_2303.WAV  SE_3001.WAV SE_3002.WAV SE_3004.WAV SE_3005.WAV SE_3006.WAV SE_3007.WAV SE_3009.WAV SE_3010.WAV SE_3011.WAV SE_3012.WAV SE_3019.WAV SE_3105.WAV SE_4200.WAV SE_4201.WAV SE_4202.WAV SE_4301.WAV SE_4401.WAV SE_4403.WAV SE_4404.WAV SE_4405.WAV SE_4406.WAV SE_4409.WAV SE_8013.WAV SE_8092.WAV
make -f makefile.sound

unpack000 -bin
@echo off
FOR %%A IN (EV_????MORNING.BIN) DO CALL :RENAME_EV_BIN %%A 0
FOR %%A IN (EV_????INTERVAL.BIN) DO CALL :RENAME_EV_BIN %%A 1
FOR %%A IN (EV_????SCHOOL_HOURS.BIN) DO CALL :RENAME_EV_BIN %%A 2
FOR %%A IN (EV_????LUNCH_BREAK.BIN) DO CALL :RENAME_EV_BIN %%A 3
FOR %%A IN (EV_????AFTER_SCHOOL.BIN) DO CALL :RENAME_EV_BIN %%A 4
FOR %%A IN (EV_????NIGHT.BIN) DO CALL :RENAME_EV_BIN %%A 6
@echo on
pceth2bin2 -s *.BIN

make -C mml
copy /Y mml\*.pmd .\

par c -C -T pceth2.par -f *.pgx *.pgd *.ppd *.scp *.pmd

:clean
@echo on
del *.BM2 *.bmp *.pg* *.WAV *.ppd *.BIN *.scp *.pmd

@echo off
goto end

rem BINファイルのリネーム
:RENAME_EV_BIN
SET FNAME=%1
SET NUM=%2
MOVE %FNAME% %FNAME:~0,7%%NUM%.BIN
EXIT /b

:end
